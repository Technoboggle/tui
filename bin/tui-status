#!/bin/bash
#
# Copyright (c) 2014 Simon Arjuna Erat (sea)  <erat.simon@gmail.com>
# All rights reserved.
#
# This program is free software: you can redistribute it and/or modify it
# under the terms of the GNU General Public License as published
# by the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>
#
# ------------------------------------------------------------------------
#
#	Variable defaults
#
	script_version=0.8
	ME="$(basename $0)"
	help_text="$ME ($script_version)
Usage: $ME ERRORLEVEL \"Message to user\" [\"centred Message\"]
Where ERRORLEVEL must be numeric
"
#
#	Variables to display
#	Diffrent for GUI or CLI
#
	source /etc/tui/colors.conf
	[[ -z "$TUI_DONE" ]] && source /etc/tui/status.conf
	
	count=${#@}
#
#	Fill array according to return value
#
	unset retvalue[@]
	retvalue[0]="$TUI_DONE" ;	retvalue[1]="$TUI_FAIL"
	retvalue[2]="$TUI_WORK" ;	retvalue[3]="$TUI_TODO"
	retvalue[4]="$TUI_SKIP" ;	retvalue[5]="$TUI_NEXT"
	retvalue[6]="$TUI_BACK" ;	retvalue[7]="$TUI_CANC"
	
	retvalue[10]="$TUI_ON"	;	retvalue[11]="$TUI_OFF"
	
	retvalue[99]="$TUI_HELP";	retvalue[111]="$TUI_INFO"
#
#	Display
#	
	[[ -z "$1" ]] && ( tui-status 1 "Usage: tui-status ERRORLEVEL [ \"Message to user\" ]" ; exit 1)
	if [[ "$1" = "-h" ]]
	then	printf "
$ME ($script_version)
Usage: $ME \$? [ \"Message to user\" ]
Interpreted numbers:\n"
		for num in $(seq 0 1 120)
		do	str="${retvalue[$num]}"
			[[ ! "" = "$(printf '%s' $str)" ]] && \
				printf "\t$str : $num\n"
		done
		printf "\n"
		exit $RET_HELP
	else	if [[ ! "" = "${retvalue[$1]}" ]]
		then	case $count in	
			#1)	tui-printf -E " " "$(echo ${retvalue[$1]})"		;;
			#2)	tui-printf -E "$2" "$(echo ${retvalue[$1]})"		;;
			#3)	tui-printf -E "$2" "$(echo $3" "${retvalue[$1]})"	;;
			*)	tui-printf -S "${@}"	;;
			
			#1)	tui-printf -S " " "${retvalue[$1]}"		;;
			#2)	tui-printf -S "$2" "${retvalue[$1]}"		;;
			#3)	tui-printf -S "$2" "$3" "${retvalue[$1]}"	;;
			4)	tui-status 1 "Too many args: $@"		;;
			esac
		else	tui-printf -E  "$2" "$3"  "ErrNr: $1"
		fi
	fi
	exit $1
